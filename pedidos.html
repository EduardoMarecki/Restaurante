<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos - Sabor & Arte</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <style>
        .order-header {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1513104890138-7c749659a591?w=1600&h=900&fit=crop') no-repeat center center;
            background-size: cover;
            padding: 100px 0;
        }

        .menu-item {
            transition: transform 0.3s ease;
            margin-bottom: 20px;
        }

        .menu-item:hover {
            transform: translateY(-5px);
        }

        .menu-item img {
            height: 200px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
        }

        .badge-dietary {
            margin-right: 5px;
        }

        .quantity-control {
            max-width: 120px;
            margin: 0 auto;
        }

        .cart-icon {
            position: relative;
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #dc3545;
            color: white;
            border-radius: 50%;
            padding: 4px 8px;
            font-size: 12px;
        }

        .delivery-time {
            font-size: 14px;
            color: #6c757d;
        }

        .order-summary {
            position: sticky;
            top: 80px;
        }

        .payment-methods img {
            height: 30px;
            margin: 5px;
            opacity: 0.7;
        }

        .payment-methods img:hover {
            opacity: 1;
        }

        .filter-button {
            margin: 5px;
            border-radius: 20px;
        }

        .filter-button.active {
            background-color: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        .payment-option {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .payment-option:hover {
            transform: translateY(-3px);
            border-color: #dc3545;
        }
        
        .payment-option.selected {
            border-color: #dc3545;
            border-width: 2px;
            background-color: #fff5f5;
        }
        
        .payment-option img {
            height: 40px;
            margin-bottom: 0.5rem;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        
        .payment-option:hover img,
        .payment-option.selected img {
            opacity: 1;
        }

        .qr-code-placeholder {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Sabor & Arte</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="sobre.html">Sobre</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cardapio.html">Cardápio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="reservas.html">Reservas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="pedidos.html">Pedidos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contato.html">Contato</a>
                    </li>
                </ul>
                <div class="cart-icon me-3" role="button" data-bs-toggle="modal" data-bs-target="#cartModal">
                    <i class="fas fa-shopping-cart text-white fs-5"></i>
                    <span class="cart-badge">0</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Cart Modal -->
    <div class="modal fade" id="cartModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Seu Carrinho</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="modalCartItems">
                        <p class="text-muted text-center">Seu carrinho está vazio</p>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Subtotal:</span>
                        <span id="modalSubtotal">R$ 0,00</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Taxa de entrega:</span>
                        <span id="modalDeliveryFee">R$ 10,00</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <strong>Total:</strong>
                        <strong class="text-danger" id="modalTotal">R$ 10,00</strong>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Continuar Comprando</button>
                    <button type="button" class="btn btn-danger" onclick="proceedToCheckout()">Finalizar Pedido</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="order-header text-white text-center">
        <div class="container">
            <h1 class="display-4 mb-4">Faça seu Pedido</h1>
            <p class="lead">Saboreie o melhor da nossa culinária no conforto da sua casa</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-5">
        <div class="container">
            <!-- Filtros -->
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <button class="btn filter-button active" data-filter="todos">Todos</button>
                    <button class="btn filter-button" data-filter="principais">Pratos Principais</button>
                    <button class="btn filter-button" data-filter="sobremesas">Sobremesas</button>
                    <button class="btn filter-button" data-filter="bebidas">Bebidas</button>
                </div>
            </div>

            <div class="row">
                <!-- Menu Items -->
                <div class="col-lg-8">
                    <div class="row">
                        <!-- Filé Mignon -->
                        <div class="col-md-6 menu-item" data-category="principais">
                            <div class="card h-100">
                                <img src="https://images.unsplash.com/photo-1546241072-48010ad2862c?w=800&h=600&fit=crop" class="card-img-top" alt="Filé Mignon">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h5 class="card-title">Filé Mignon ao Molho de Vinho</h5>
                                        <span class="badge bg-danger">R$ 89,00</span>
                                    </div>
                                    <p class="card-text">Filé mignon grelhado com molho de vinho tinto e batatas rústicas</p>
                                    <div class="mb-3">
                                        <span class="badge bg-success badge-dietary">Sem Glúten</span>
                                        <span class="badge bg-info badge-dietary">Low Carb</span>
                                    </div>
                                    <div class="quantity-control input-group">
                                        <button class="btn btn-outline-secondary decrease-qty" type="button">-</button>
                                        <input type="number" class="form-control text-center item-qty" value="0" min="0">
                                        <button class="btn btn-outline-secondary increase-qty" type="button">+</button>
                                    </div>
                                </div>
                                <div class="card-footer bg-white border-top-0">
                                    <button class="btn btn-danger w-100 add-to-cart">Adicionar ao Carrinho</button>
                                </div>
                            </div>
                        </div>

                        <!-- Salmão -->
                        <div class="col-md-6 menu-item" data-category="principais">
                            <div class="card h-100">
                                <img src="https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=800&h=600&fit=crop" class="card-img-top" alt="Salmão">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h5 class="card-title">Salmão Grelhado</h5>
                                        <span class="badge bg-danger">R$ 78,00</span>
                                    </div>
                                    <p class="card-text">Salmão grelhado com legumes salteados e molho de ervas</p>
                                    <div class="mb-3">
                                        <span class="badge bg-success badge-dietary">Sem Glúten</span>
                                        <span class="badge bg-warning badge-dietary">Rico em Ômega 3</span>
                                    </div>
                                    <div class="quantity-control input-group">
                                        <button class="btn btn-outline-secondary decrease-qty" type="button">-</button>
                                        <input type="number" class="form-control text-center item-qty" value="0" min="0">
                                        <button class="btn btn-outline-secondary increase-qty" type="button">+</button>
                                    </div>
                                </div>
                                <div class="card-footer bg-white border-top-0">
                                    <button class="btn btn-danger w-100 add-to-cart">Adicionar ao Carrinho</button>
                                </div>
                            </div>
                        </div>

                        <!-- Fettuccine -->
                        <div class="col-md-6 menu-item" data-category="principais">
                            <div class="card h-100">
                                <img src="https://images.unsplash.com/photo-1645112411341-6c4fd023714a?w=800&h=600&fit=crop" class="card-img-top" alt="Fettuccine">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h5 class="card-title">Fettuccine ao Molho Alfredo</h5>
                                        <span class="badge bg-danger">R$ 62,00</span>
                                    </div>
                                    <p class="card-text">Massa fresca com molho cremoso, cogumelos e parmesão</p>
                                    <div class="mb-3">
                                        <span class="badge bg-secondary badge-dietary">Vegetariano</span>
                                    </div>
                                    <div class="quantity-control input-group">
                                        <button class="btn btn-outline-secondary decrease-qty" type="button">-</button>
                                        <input type="number" class="form-control text-center item-qty" value="0" min="0">
                                        <button class="btn btn-outline-secondary increase-qty" type="button">+</button>
                                    </div>
                                </div>
                                <div class="card-footer bg-white border-top-0">
                                    <button class="btn btn-danger w-100 add-to-cart">Adicionar ao Carrinho</button>
                                </div>
                            </div>
                        </div>

                        <!-- Tiramisu -->
                        <div class="col-md-6 menu-item" data-category="sobremesas">
                            <div class="card h-100">
                                <img src="https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=800&h=600&fit=crop" class="card-img-top" alt="Tiramisu">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h5 class="card-title">Tiramisu</h5>
                                        <span class="badge bg-danger">R$ 28,00</span>
                                    </div>
                                    <p class="card-text">Clássica sobremesa italiana com café e mascarpone</p>
                                    <div class="mb-3">
                                        <span class="badge bg-secondary badge-dietary">Vegetariano</span>
                                        <span class="badge bg-warning badge-dietary">Contém Glúten</span>
                                    </div>
                                    <div class="quantity-control input-group">
                                        <button class="btn btn-outline-secondary decrease-qty" type="button">-</button>
                                        <input type="number" class="form-control text-center item-qty" value="0" min="0">
                                        <button class="btn btn-outline-secondary increase-qty" type="button">+</button>
                                    </div>
                                </div>
                                <div class="card-footer bg-white border-top-0">
                                    <button class="btn btn-danger w-100 add-to-cart">Adicionar ao Carrinho</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="col-lg-4">
                    <div class="card order-summary">
                        <div class="card-body">
                            <h4 class="card-title mb-4">Seu Pedido</h4>
                            <div id="cart-items">
                                <p class="text-muted text-center">Seu carrinho está vazio</p>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Subtotal:</span>
                                <span>R$ 0,00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Taxa de entrega:</span>
                                <span>R$ 10,00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-4">
                                <strong>Total:</strong>
                                <strong class="text-danger">R$ 10,00</strong>
                            </div>

                            <!-- Delivery Options -->
                            <h5 class="mb-3">Forma de Entrega</h5>
                            <div class="row g-2 mb-4">
                                <div class="col-6">
                                    <div class="border rounded p-3 text-center">
                                        <i class="fas fa-bicycle mb-2"></i>
                                        <h6>Delivery</h6>
                                        <small class="delivery-time">30-45 min</small>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="border rounded p-3 text-center">
                                        <i class="fas fa-store mb-2"></i>
                                        <h6>Retirada</h6>
                                        <small class="delivery-time">15-20 min</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Address Form -->
                            <h5 class="mb-3">Endereço de Entrega</h5>
                            <div class="mb-4 address-form">
                                <div class="mb-2">
                                    <input type="text" class="form-control" id="cep" placeholder="CEP" maxlength="8">
                                    <div class="invalid-feedback">CEP inválido</div>
                                </div>
                                <div class="mb-2">
                                    <input type="text" class="form-control" id="endereco" placeholder="Endereço" readonly>
                                </div>
                                <div class="row mb-2">
                                    <div class="col">
                                        <input type="text" class="form-control" id="numero" placeholder="Número">
                                    </div>
                                    <div class="col">
                                        <input type="text" class="form-control" id="complemento" placeholder="Complemento">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <input type="text" class="form-control" id="bairro" placeholder="Bairro" readonly>
                                    </div>
                                    <div class="col">
                                        <input type="text" class="form-control" id="cidade" placeholder="Cidade" readonly>
                                    </div>
                                </div>
                            </div>

                            <!-- Payment Methods -->
                            <h5 class="mb-3">Formas de Pagamento</h5>
                            <div class="payment-methods mb-4">
                                <div class="row g-2">
                                    <div class="col-6">
                                        <div class="payment-option border rounded p-3 text-center" data-payment="credit">
                                            <img src="https://cdn-icons-png.flaticon.com/512/196/196578.png" alt="Cartão de Crédito">
                                            <div class="mt-2">Cartão de Crédito</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="payment-option border rounded p-3 text-center" data-payment="debit">
                                            <img src="https://cdn-icons-png.flaticon.com/512/196/196565.png" alt="Cartão de Débito">
                                            <div class="mt-2">Cartão de Débito</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="payment-option border rounded p-3 text-center" data-payment="pix">
                                            <img src="https://cdn-icons-png.flaticon.com/512/217/217853.png" alt="PIX">
                                            <div class="mt-2">PIX</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="payment-option border rounded p-3 text-center" data-payment="cash">
                                            <img src="https://cdn-icons-png.flaticon.com/512/4090/4090458.png" alt="Dinheiro">
                                            <div class="mt-2">Dinheiro</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campos específicos para cada forma de pagamento -->
                                <div id="payment-details" class="mt-3" style="display: none;">
                                    <!-- Cartão de Crédito -->
                                    <div id="credit-details" class="payment-form">
                                        <div class="mb-2">
                                            <input type="text" class="form-control" placeholder="Número do Cartão" maxlength="19">
                                        </div>
                                        <div class="row mb-2">
                                            <div class="col">
                                                <input type="text" class="form-control" placeholder="Validade (MM/AA)" maxlength="5">
                                            </div>
                                            <div class="col">
                                                <input type="text" class="form-control" placeholder="CVV" maxlength="3">
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <input type="text" class="form-control" placeholder="Nome no Cartão">
                                        </div>
                                        <div class="mb-2">
                                            <select class="form-select" id="installments">
                                                <option value="">Selecione as parcelas</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Cartão de Débito -->
                                    <div id="debit-details" class="payment-form">
                                        <div class="mb-2">
                                            <input type="text" class="form-control" placeholder="Número do Cartão" maxlength="19">
                                        </div>
                                        <div class="row mb-2">
                                            <div class="col">
                                                <input type="text" class="form-control" placeholder="Validade (MM/AA)" maxlength="5">
                                            </div>
                                            <div class="col">
                                                <input type="text" class="form-control" placeholder="CVV" maxlength="3">
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <input type="text" class="form-control" placeholder="Nome no Cartão">
                                        </div>
                                    </div>

                                    <!-- PIX -->
                                    <div id="pix-details" class="payment-form text-center">
                                        <div class="qr-code-placeholder bg-light rounded p-4 mb-3">
                                            <i class="fas fa-qrcode fa-4x text-muted"></i>
                                            <p class="mt-2 mb-0">QR Code será gerado ao finalizar o pedido</p>
                                        </div>
                                    </div>

                                    <!-- Dinheiro -->
                                    <div id="cash-details" class="payment-form">
                                        <div class="mb-2">
                                            <input type="number" class="form-control" placeholder="Troco para quanto?">
                                            <small class="text-muted">Deixe em branco se não precisar de troco</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button class="btn btn-danger w-100">Finalizar Pedido</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>Sabor & Arte</h5>
                    <p>Experiências gastronômicas únicas desde 2010.</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Contato</h5>
                    <p>
                        <i class="fas fa-map-marker-alt me-2"></i> Rua Lothário Boutin, 49<br>
                        <span class="ms-4">Curitiba, PR - CEP: 81020-490</span><br>
                        <i class="fas fa-phone me-2"></i> (11) 1234-5678<br>
                        <i class="fas fa-envelope me-2"></i> contato@saborarte.com.br
                    </p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Siga-nos</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <small>&copy; 2024 Sabor & Arte. Todos os direitos reservados.</small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script>
        // Estado do carrinho
        let cart = [];
        let deliveryOption = 'delivery';
        const DELIVERY_FEE = 10.00;
        let selectedPayment = '';

        // Classe para item do carrinho
        class CartItem {
            constructor(id, name, price, quantity = 1) {
                this.id = id;
                this.name = name;
                this.price = price;
                this.quantity = quantity;
            }

            get total() {
                return this.price * this.quantity;
            }
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            initializeCart();
            setupEventListeners();
        });

        function initializeCart() {
            // Recuperar carrinho do localStorage se existir
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartDisplay();
            }
        }

        function setupEventListeners() {
            // Filtro de categorias
            document.querySelectorAll('.filter-button').forEach(button => {
                button.addEventListener('click', () => {
                    const filter = button.getAttribute('data-filter');
                    filterMenuItems(filter);
                });
            });

            // Controle de quantidade nos cards
            document.querySelectorAll('.quantity-control').forEach(control => {
                const input = control.querySelector('.item-qty');
                const decreaseBtn = control.querySelector('.decrease-qty');
                const increaseBtn = control.querySelector('.increase-qty');

                decreaseBtn.addEventListener('click', () => {
                    const currentValue = parseInt(input.value) || 0;
                    if (currentValue > 0) {
                        input.value = currentValue - 1;
                    }
                });

                increaseBtn.addEventListener('click', () => {
                    const currentValue = parseInt(input.value) || 0;
                    input.value = currentValue + 1;
                });

                input.addEventListener('change', () => {
                    let value = parseInt(input.value) || 0;
                    if (value < 0) value = 0;
                    input.value = value;
                });
            });

            // Botões de adicionar ao carrinho
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    const card = this.closest('.card');
                    const quantityInput = card.querySelector('.item-qty');
                    const quantity = parseInt(quantityInput.value);
                    
                    if (quantity > 0) {
                        const name = card.querySelector('.card-title').textContent;
                        const priceText = card.querySelector('.badge.bg-danger').textContent;
                        const price = parseFloat(priceText.replace('R$ ', '').replace(',', '.'));
                        
                        addToCart(name, price, quantity);
                        quantityInput.value = '0';
                        
                        // Feedback visual
                        const originalText = this.textContent;
                        this.textContent = 'Adicionado!';
                        this.disabled = true;
                        setTimeout(() => {
                            this.textContent = originalText;
                            this.disabled = false;
                        }, 1000);
                    }
                });
            });

            // CEP input com máscara
            const cepInput = document.getElementById('cep');
            if (cepInput) {
                cepInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 8) value = value.substr(0, 8);
                    e.target.value = value.replace(/^(\d{5})(\d)/, '$1-$2');
                    
                    if (value.length === 8) {
                        searchCEP(value);
                    }
                });
            }

            // Opções de entrega
            const deliveryOptions = document.querySelectorAll('.border.rounded.p-3');
            deliveryOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove seleção anterior
                    deliveryOptions.forEach(opt => opt.classList.remove('border-danger'));
                    this.classList.add('border-danger');

                    const type = this.querySelector('h6').textContent.toLowerCase();
                    selectDeliveryOption(type);
                });
            });

            // Formulário de endereço
            document.querySelectorAll('input[type="text"]').forEach(input => {
                input.addEventListener('input', validateForm);
            });

            // Botão finalizar pedido
            document.querySelector('.btn-danger.w-100').addEventListener('click', finalizePedido);

            // Formas de pagamento
            document.querySelectorAll('.payment-option').forEach(option => {
                option.addEventListener('click', function() {
                    const paymentType = this.dataset.payment;
                    selectPaymentMethod(paymentType, this);
                });
            });

            // Formatação de cartão
            document.querySelectorAll('input[placeholder="Número do Cartão"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 16) value = value.substr(0, 16);
                    value = value.replace(/(\d{4})/g, '$1 ').trim();
                    e.target.value = value;
                });
            });

            // Formatação de validade
            document.querySelectorAll('input[placeholder="Validade (MM/AA)"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 4) value = value.substr(0, 4);
                    if (value.length > 2) {
                        value = value.substr(0, 2) + '/' + value.substr(2);
                    }
                    e.target.value = value;
                });
            });

            // Formatação de CVV
            document.querySelectorAll('input[placeholder="CVV"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 3) value = value.substr(0, 3);
                    e.target.value = value;
                });
            });
        }

        function filterMenuItems(filter) {
            document.querySelectorAll('.filter-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');

            document.querySelectorAll('.menu-item').forEach(item => {
                if (filter === 'todos' || item.getAttribute('data-category') === filter) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function addToCart(name, price, quantity) {
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push(new CartItem(Date.now(), name, price, quantity));
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
        }

        function updateQuantity(id, newQuantity) {
            const item = cart.find(item => item.id === id);
            if (item) {
                if (newQuantity <= 0) {
                    removeFromCart(id);
                } else {
                    item.quantity = newQuantity;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartDisplay();
                }
            }
        }

        function updateCartDisplay() {
            const cartContainer = document.getElementById('cart-items');
            const modalCartContainer = document.getElementById('modalCartItems');
            const cartBadge = document.querySelector('.cart-badge');
            
            // Atualiza o contador do carrinho
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartBadge.textContent = totalItems || '0';
            
            if (cart.length === 0) {
                const emptyMessage = '<p class="text-muted text-center">Seu carrinho está vazio</p>';
                cartContainer.innerHTML = emptyMessage;
                modalCartContainer.innerHTML = emptyMessage;
                updateTotals(0);
                return;
            }

            const cartHTML = cart.map(item => `
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <h6 class="mb-0">${item.name}</h6>
                        <small class="text-muted">R$ ${item.price.toFixed(2)} x ${item.quantity}</small>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="input-group input-group-sm me-2" style="width: 100px;">
                            <button class="btn btn-outline-secondary" type="button" 
                                onclick="updateQuantity(${item.id}, ${item.quantity - 1})">-</button>
                            <input type="number" class="form-control text-center" value="${item.quantity}" 
                                onchange="updateQuantity(${item.id}, this.value)" min="0">
                            <button class="btn btn-outline-secondary" type="button" 
                                onclick="updateQuantity(${item.id}, ${item.quantity + 1})">+</button>
                        </div>
                        <span class="me-3">R$ ${(item.price * item.quantity).toFixed(2)}</span>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            cartContainer.innerHTML = cartHTML;
            modalCartContainer.innerHTML = cartHTML;

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            updateTotals(subtotal);
        }

        function updateTotals(subtotal) {
            const subtotalElement = document.querySelector('.d-flex.justify-content-between.mb-2 span:last-child');
            const totalElement = document.querySelector('.d-flex.justify-content-between.mb-4 strong:last-child');
            const modalSubtotal = document.getElementById('modalSubtotal');
            const modalTotal = document.getElementById('modalTotal');
            
            const subtotalFormatted = `R$ ${subtotal.toFixed(2)}`;
            const total = subtotal + (deliveryOption === 'delivery' ? DELIVERY_FEE : 0);
            const totalFormatted = `R$ ${total.toFixed(2)}`;
            
            subtotalElement.textContent = subtotalFormatted;
            totalElement.textContent = totalFormatted;
            modalSubtotal.textContent = subtotalFormatted;
            modalTotal.textContent = totalFormatted;
        }

        function selectDeliveryOption(type) {
            deliveryOption = type;
            const addressForm = document.querySelector('.address-form');
            
            if (type === 'delivery') {
                addressForm.style.display = 'block';
                document.getElementById('cep').focus();
            } else {
                addressForm.style.display = 'none';
                // Limpa os campos do endereço
                document.querySelectorAll('.address-form input').forEach(input => {
                    input.value = '';
                });
            }
            
            // Atualiza o botão de finalizar
            const finishButton = document.querySelector('.btn-danger.w-100');
            finishButton.disabled = type === 'delivery' && !validateForm();
            
            updateCartDisplay();
        }

        function selectPaymentMethod(type, element) {
            selectedPayment = type;
            
            // Remove seleção anterior
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');

            // Mostra detalhes do pagamento
            const paymentDetails = document.getElementById('payment-details');
            const paymentForms = document.querySelectorAll('.payment-form');
            
            paymentForms.forEach(form => form.style.display = 'none');
            paymentDetails.style.display = 'block';
            
            const selectedForm = document.getElementById(`${type}-details`);
            if (selectedForm) {
                selectedForm.style.display = 'block';
            }

            // Se for cartão de crédito, atualiza as parcelas
            if (type === 'credit') {
                updateInstallments();
            }

            validateForm();
        }

        function updateInstallments() {
            const select = document.getElementById('installments');
            const total = cart.reduce((sum, item) => sum + item.total, 0) + 
                         (deliveryOption === 'delivery' ? DELIVERY_FEE : 0);
            
            select.innerHTML = '<option value="">Selecione as parcelas</option>';
            
            // Adiciona opções de parcelamento
            for (let i = 1; i <= 12; i++) {
                const value = total / i;
                if (value >= 5) { // Mínimo de R$ 5,00 por parcela
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i === 1 
                        ? `À vista - R$ ${total.toFixed(2)}`
                        : `${i}x de R$ ${value.toFixed(2)} - Total: R$ ${total.toFixed(2)}`;
                    select.appendChild(option);
                }
            }
        }

        function validateForm() {
            if (!cart.length) return false;
            
            // Validação básica
            let isValid = true;

            // Se for delivery, valida endereço
            if (deliveryOption === 'delivery') {
                const requiredFields = {
                    'cep': document.getElementById('cep'),
                    'endereco': document.getElementById('endereco'),
                    'numero': document.getElementById('numero')
                };

                isValid = Object.values(requiredFields).every(input => 
                    input.value.trim() !== '' && !input.classList.contains('is-invalid')
                );
            }

            // Valida forma de pagamento
            if (!selectedPayment) {
                isValid = false;
            } else {
                const form = document.getElementById(`${selectedPayment}-details`);
                if (form) {
                    const inputs = form.querySelectorAll('input, select');
                    inputs.forEach(input => {
                        if (input.required && !input.value.trim()) {
                            isValid = false;
                        }
                    });
                }
            }

            document.querySelector('.btn-danger.w-100').disabled = !isValid;
            return isValid;
        }

        function finalizePedido() {
            if (!validateForm()) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }

            // Simular processamento do pedido
            const btn = document.querySelector('.btn-danger.w-100');
            const originalText = btn.textContent;
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processando...';

            setTimeout(() => {
                let mensagem = 'Pedido realizado com sucesso!\n\n';
                
                if (selectedPayment === 'pix') {
                    mensagem += 'O QR Code do PIX será exibido na próxima tela.';
                } else if (selectedPayment === 'credit' || selectedPayment === 'debit') {
                    mensagem += 'Sua transação foi aprovada!';
                } else if (selectedPayment === 'cash') {
                    const trocoInput = document.querySelector('#cash-details input');
                    if (trocoInput.value) {
                        mensagem += `Prepararemos o troco para R$ ${trocoInput.value}.`;
                    }
                }

                alert(mensagem);
                cart = [];
                localStorage.removeItem('cart');
                updateCartDisplay();
                btn.textContent = originalText;
                btn.disabled = false;

                // Limpa formulários
                document.querySelectorAll('input').forEach(input => input.value = '');
                document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
                document.getElementById('payment-details').style.display = 'none';
            }, 2000);
        }

        async function searchCEP(cep) {
            const cepInput = document.getElementById('cep');
            const endereco = document.getElementById('endereco');
            const bairro = document.getElementById('bairro');
            const cidade = document.getElementById('cidade');
            
            try {
                endereco.value = 'Buscando...';
                cepInput.classList.remove('is-invalid');
                
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                if (!response.ok) throw new Error('Erro na busca do CEP');
                
                const data = await response.json();
                
                if (data.erro) {
                    throw new Error('CEP não encontrado');
                }

                endereco.value = data.logradouro || '';
                bairro.value = data.bairro || '';
                cidade.value = `${data.localidade}/${data.uf}`;
                
                if (!data.logradouro) {
                    endereco.readOnly = false;
                    endereco.focus();
                } else {
                    document.getElementById('numero').focus();
                }
                
                validateForm();
            } catch (error) {
                cepInput.classList.add('is-invalid');
                endereco.value = '';
                bairro.value = '';
                cidade.value = '';
                document.querySelector('.invalid-feedback').textContent = 
                    error.message === 'CEP não encontrado' ? 'CEP não encontrado' : 'Erro ao buscar CEP';
            }
        }

        function proceedToCheckout() {
            const modal = bootstrap.Modal.getInstance(document.getElementById('cartModal'));
            modal.hide();
            document.querySelector('.order-summary').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html> 